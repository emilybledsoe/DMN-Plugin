{"version":3,"sources":["../../../src/features/interaction-events/InteractionEvents.js"],"names":["closest","domClosest","EVENTS","InteractionEvents","config","eventBus","event","target","type","node","findClosestCell","elementId","getAttribute","e","_eventBus","createEvent","id","fire","defaultPrevented","preventDefault","cancelBubble","stopPropagation","_container","container","on","_addEventListeners","_removeEventListeners","events","forEach","addEventListener","_handleEvent","removeEventListener","$inject","element"],"mappings":";;;;;;;;AAAA,SACEA,OAAO,IAAIC,UADb,QAEO,SAFP;AAIA,IAAMC,MAAM,GAAG,CACb,OADa,EAEb,UAFa,EAGb,aAHa,EAIb,WAJa,EAKb,SALa,EAMb,YANa,EAOb,YAPa,EAQb,UARa,EASb,WATa,EAUb,WAVa,EAWb,SAXa,EAYb,UAZa,EAab,MAba,EAcb,WAda,EAeb,SAfa,EAgBb,UAhBa,EAiBb,WAjBa,EAkBb,WAlBa,EAmBb,MAnBa,CAAf;AAuBA;;;;;;;IAMqBC,iB;;;AAEnB,6BAAYC,MAAZ,EAAoBC,QAApB,EAA8B;AAAA;;AAAA;;AAAA,0CA6Bf,UAACC,KAAD,EAAW;AAAA,UAChBC,MADgB,GACCD,KADD,CAChBC,MADgB;AAAA,UACRC,IADQ,GACCF,KADD,CACRE,IADQ;AAGxB,UAAMC,IAAI,GAAGC,eAAe,CAACH,MAAD,CAA5B;;AAEA,UAAI,CAACE,IAAL,EAAW;AACT;AACD;;AAED,UAAME,SAAS,GAAGF,IAAI,CAACG,YAAL,CAAkB,iBAAlB,CAAlB;;AAEA,UAAID,SAAJ,EAAe;AACb,YAAME,CAAC,GAAG,KAAI,CAACC,SAAL,CAAeC,WAAf,CAA2B;AACnCC,UAAAA,EAAE,EAAEL,SAD+B;AAEnCL,UAAAA,KAAK,EAALA,KAFmC;AAGnCG,UAAAA,IAAI,EAAJA,IAHmC;AAInCF,UAAAA,MAAM,EAAEE;AAJ2B,SAA3B,CAAV;;AAOA,QAAA,KAAI,CAACK,SAAL,CAAeG,IAAf,gBAA4BT,IAA5B,GAAoCK,CAApC;;AAEA,YAAIA,CAAC,CAACK,gBAAN,EAAwB;AACtBZ,UAAAA,KAAK,CAACa,cAAN;AACD;;AAED,YAAIN,CAAC,CAACO,YAAN,EAAoB;AAClBd,UAAAA,KAAK,CAACe,eAAN;AACD;AACF;AACF,KA1D6B;;AAC5B,SAAKP,SAAL,GAAiBT,QAAjB;AACA,SAAKiB,UAAL,GAAkBlB,MAAM,CAACmB,SAAzB;AAEAlB,IAAAA,QAAQ,CAACmB,EAAT,CAAY,YAAZ,EAA0B,YAAM;AAC9B,MAAA,KAAI,CAACC,kBAAL,CAAwBvB,MAAxB;AACD,KAFD;AAIAG,IAAAA,QAAQ,CAACmB,EAAT,CAAY,eAAZ,EAA6B,YAAM;AACjC,MAAA,KAAI,CAACE,qBAAL,CAA2BxB,MAA3B;AACD,KAFD;AAGD;;;;uCAEkByB,M,EAAQ;AAAA;;AACzB,UAAMJ,SAAS,GAAG,KAAKD,UAAvB;AAEAK,MAAAA,MAAM,CAACC,OAAP,CAAe,UAAAtB,KAAK,EAAI;AACtBiB,QAAAA,SAAS,CAACM,gBAAV,CAA2BvB,KAA3B,EAAkC,MAAI,CAACwB,YAAvC;AACD,OAFD;AAGD;;;0CAEqBH,M,EAAQ;AAAA;;AAC5B,UAAMJ,SAAS,GAAG,KAAKD,UAAvB;AAEAK,MAAAA,MAAM,CAACC,OAAP,CAAe,UAAAtB,KAAK,EAAI;AACtBiB,QAAAA,SAAS,CAACQ,mBAAV,CAA8BzB,KAA9B,EAAqC,MAAI,CAACwB,YAA1C;AACD,OAFD;AAGD;;;;;;SA7BkB3B,iB;AA+DrBA,iBAAiB,CAAC6B,OAAlB,GAA4B,CAC1B,iBAD0B,EAE1B,UAF0B,CAA5B,C,CAKA;;AAEA,SAAStB,eAAT,CAAyBuB,OAAzB,EAAkC;AAChC,SAAOhC,UAAU,CAACgC,OAAD,EAAU,mBAAV,EAA+B,IAA/B,CAAjB;AACD","sourcesContent":["import {\n  closest as domClosest\n} from 'min-dom';\n\nconst EVENTS = [\n  'click',\n  'dblclick',\n  'contextmenu',\n  'mousedown',\n  'mouseup',\n  'mouseenter',\n  'mouseleave',\n  'mouseout',\n  'mouseover',\n  'mousemove',\n  'focusin',\n  'focusout',\n  'drag',\n  'dragstart',\n  'dragend',\n  'dragover',\n  'dragenter',\n  'dragleave',\n  'drop'\n];\n\n\n/**\n * Provides interaction events on the table.\n *\n * @param {RenderConfig} config\n * @param {EventBus} eventBus\n */\nexport default class InteractionEvents {\n\n  constructor(config, eventBus) {\n    this._eventBus = eventBus;\n    this._container = config.container;\n\n    eventBus.on('table.init', () => {\n      this._addEventListeners(EVENTS);\n    });\n\n    eventBus.on('table.destroy', () => {\n      this._removeEventListeners(EVENTS);\n    });\n  }\n\n  _addEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.addEventListener(event, this._handleEvent);\n    });\n  }\n\n  _removeEventListeners(events) {\n    const container = this._container;\n\n    events.forEach(event => {\n      container.removeEventListener(event, this._handleEvent);\n    });\n  }\n\n  _handleEvent = (event) => {\n    const { target, type } = event;\n\n    const node = findClosestCell(target);\n\n    if (!node) {\n      return;\n    }\n\n    const elementId = node.getAttribute('data-element-id');\n\n    if (elementId) {\n      const e = this._eventBus.createEvent({\n        id: elementId,\n        event,\n        node,\n        target: node\n      });\n\n      this._eventBus.fire(`cell.${type}`, e);\n\n      if (e.defaultPrevented) {\n        event.preventDefault();\n      }\n\n      if (e.cancelBubble) {\n        event.stopPropagation();\n      }\n    }\n  }\n}\n\nInteractionEvents.$inject = [\n  'config.renderer',\n  'eventBus'\n];\n\n// helpers /////////////\n\nfunction findClosestCell(element) {\n  return domClosest(element, '[data-element-id]', true);\n}"],"file":"InteractionEvents.js"}