{"version":3,"sources":["../../src/render/Components.js"],"names":["isFunction","isNumber","DEFAULT_PRIORITY","Components","_listeners","type","context","listeners","component","i","length","callback","components","push","priority","Error","_getListeners","existingListener","idx","newListener","splice","listener","listenerCallback"],"mappings":"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","sourcesContent":["import {\n  isFunction,\n  isNumber\n} from 'min-dash';\n\nconst DEFAULT_PRIORITY = 1000;\n\n\nexport default class Components {\n\n  constructor() {\n    this._listeners = {};\n  }\n\n  getComponent(type, context) {\n    const listeners = this._listeners[type];\n\n    if (!listeners) {\n      return;\n    }\n\n    let component;\n\n    for (let i = 0; i < listeners.length; i++) {\n      component = listeners[i].callback(context);\n\n      if (component) {\n        break;\n      }\n    }\n\n    return component;\n  }\n\n  getComponents(type, context) {\n    const listeners = this._listeners[type];\n\n    const components = [];\n\n    if (!listeners) {\n      return components;\n    }\n\n\n    for (let i = 0; i < listeners.length; i++) {\n      const component = listeners[i].callback(context);\n\n      if (component) {\n        components.push(component);\n      }\n    }\n\n    if (!components.length) {\n      return components;\n    }\n\n    return components;\n  }\n\n  onGetComponent(type, priority, callback) {\n    if (isFunction(priority)) {\n      callback = priority;\n      priority = DEFAULT_PRIORITY;\n    }\n\n    if (!isNumber(priority)) {\n      throw new Error('priority must be a number');\n    }\n\n    const listeners = this._getListeners(type);\n\n    let existingListener,\n        idx;\n\n    const newListener = { priority, callback };\n\n    for (idx = 0; (existingListener = listeners[idx]); idx++) {\n      if (existingListener.priority < priority) {\n\n        // prepend newListener at before existingListener\n        listeners.splice(idx, 0, newListener);\n        return;\n      }\n    }\n\n    listeners.push(newListener);\n  }\n\n  offGetComponent(type, callback) {\n    const listeners = this._getListeners(type);\n\n    let listener,\n        listenerCallback,\n        idx;\n\n    if (callback) {\n\n      // move through listeners from back to front\n      // and remove matching listeners\n      for (idx = listeners.length - 1; (listener = listeners[idx]); idx--) {\n        listenerCallback = listener.callback;\n\n        if (listenerCallback === callback) {\n          listeners.splice(idx, 1);\n        }\n      }\n    } else {\n      // clear listeners\n      listeners.length = 0;\n    }\n  }\n\n  _getListeners(type) {\n    let listeners = this._listeners[type];\n\n    if (!listeners) {\n      this._listeners[type] = listeners = [];\n    }\n\n    return listeners;\n  }\n}"],"file":"Components.js"}